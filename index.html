<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ë¶€ì‚°ì‹œ ì—¬ê¶Œë°œê¸‰ ë¯¼ì› RAG AI ìƒë‹´</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: 'Segoe UI', Taejaewoo, -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
      display: flex; justify-content: center; align-items: center;
      height: 100vh; margin: 0; position: relative;
    }
    
    .chatbot-container {
      width: 420px; height: 750px; background: #fff;
      border-radius: 20px; box-shadow: 0 15px 40px rgba(0,0,0,0.2);
      display: flex; flex-direction: column; overflow: hidden;
      position: relative;
    }
    
    .chatbot-header {
      background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
      color: white; padding: 20px; text-align: center; position: relative;
    }
    
    .header-badge {
      position: absolute; top: 12px; left: 12px;
      background: rgba(34, 197, 94, 0.9); color: white;
      padding: 4px 8px; border-radius: 10px; font-size: 10px;
      font-weight: 600; display: flex; align-items: center; gap: 4px;
    }
    
    .header-controls {
      position: absolute; top: 12px; right: 12px;
      display: flex; gap: 8px;
    }
    
    .control-btn {
      width: 28px; height: 28px; border: none; border-radius: 50%;
      background: rgba(255, 255, 255, 0.2); color: white;
      cursor: pointer; font-size: 12px; transition: all 0.2s;
    }
    
    .control-btn:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: scale(1.1);
    }
    
    .header-title {
      font-size: 18px; font-weight: 600; margin-bottom: 4px;
    }
    
    .header-subtitle {
      font-size: 12px; opacity: 0.9;
    }
    
    .chat-messages {
      flex: 1; padding: 20px; overflow-y: auto; background: #f8fafc;
      scrollbar-width: thin; scrollbar-color: #cbd5e1 transparent;
    }
    
    .chat-messages::-webkit-scrollbar { width: 4px; }
    .chat-messages::-webkit-scrollbar-track { background: transparent; }
    .chat-messages::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 2px; }
    
    .message {
      margin-bottom: 16px; display: flex; align-items: flex-end;
      animation: slideIn 0.3s ease-out;
    }
    
    @keyframes slideIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .message.user { justify-content: flex-end; }
    .message.bot { justify-content: flex-start; }
    
    .message-avatar {
      width: 32px; height: 32px; border-radius: 50%;
      margin: 0 8px; display: flex; align-items: center; justify-content: center;
      font-size: 14px; flex-shrink: 0;
    }
    
    .bot-avatar {
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      color: white;
    }
    
    .user-avatar {
      background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
      color: white;
    }
    
    .message-bubble {
      max-width: 70%; padding: 12px 16px; border-radius: 16px;
      font-size: 14px; line-height: 1.5; position: relative;
    }
    
    .message.user .message-bubble {
      background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
      color: white;
    }
    
    .message.bot .message-bubble {
      background: white; color: #374151;
      border: 1px solid #e5e7eb;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }
    
    .typing-indicator {
      display: none; align-items: center; margin-bottom: 16px;
    }
    
    .typing-bubble {
      background: #f3f4f6; border: 1px dashed #9ca3af;
      color: #6b7280; font-style: italic;
      padding: 12px 16px; border-radius: 16px;
      display: flex; align-items: center; gap: 8px;
    }
    
    .spinner {
      width: 16px; height: 16px;
      border: 2px solid #e5e7eb; border-top: 2px solid #3b82f6;
      border-radius: 50%; animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .reference-sources {
      margin-top: 10px; padding: 10px; background: #eff6ff;
      border-left: 3px solid #3b82f6; border-radius: 0 8px 8px 0;
      font-size: 11px; color: #1e40af; line-height: 1.4;
    }
    
    .reference-sources strong {
      display: block; margin-bottom: 6px; font-size: 12px;
    }
    
    .quick-suggestions {
      padding: 0 20px 15px; display: flex; flex-wrap: wrap; gap: 8px;
    }
    
    .suggestion-chip {
      background: white; border: 1px solid #d1d5db;
      border-radius: 20px; padding: 8px 14px; font-size: 12px;
      cursor: pointer; transition: all 0.2s; color: #4b5563;
    }
    
    .suggestion-chip:hover {
      background: #f9fafb; border-color: #3b82f6;
      color: #3b82f6; transform: translateY(-1px);
    }
    
    .input-area {
      padding: 20px; background: white; border-top: 1px solid #e5e7eb;
    }
    
    .input-container {
      display: flex; align-items: center; gap: 12px; position: relative;
    }
    
    .message-input {
      flex: 1; padding: 12px 16px; border: 1px solid #d1d5db;
      border-radius: 24px; font-size: 14px; outline: none;
      background: #f9fafb; transition: all 0.2s;
    }
    
    .message-input:focus {
      border-color: #3b82f6; background: white;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }
    
    .send-button {
      width: 44px; height: 44px; border: none; border-radius: 50%;
      background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
      color: white; cursor: pointer; font-size: 16px;
      transition: all 0.2s; display: flex; align-items: center; justify-content: center;
    }
    
    .send-button:hover:not(:disabled) {
      transform: scale(1.05); box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
    }
    
    .send-button:disabled {
      opacity: 0.5; cursor: not-allowed;
    }
    
    .api-status {
      position: absolute; bottom: 90px; left: 20px; right: 20px;
      background: #f3f4f6; border: 1px solid #d1d5db;
      border-radius: 8px; padding: 8px 12px; font-size: 11px;
      color: #6b7280; display: none; text-align: center;
    }
    
    .api-status.connected {
      background: #dcfce7; border-color: #16a34a; color: #15803d;
    }
    
    .api-status.error {
      background: #fef2f2; border-color: #dc2626; color: #dc2626;
    }
    
    .settings-panel {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.6); display: none; justify-content: center;
      align-items: center; z-index: 1000;
    }
    
    .settings-content {
      background: white; border-radius: 16px; padding: 24px;
      width: 90%; max-width: 480px; max-height: 80vh; overflow-y: auto;
    }
    
    .settings-header {
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 20px; padding-bottom: 12px; border-bottom: 1px solid #e5e7eb;
    }
    
    .settings-header h3 { font-size: 18px; color: #111827; }
    
    .close-btn {
      background: none; border: none; font-size: 20px;
      cursor: pointer; color: #6b7280; padding: 4px;
      border-radius: 4px; transition: background 0.2s;
    }
    
    .close-btn:hover { background: #f3f4f6; }
    
    .form-group { margin-bottom: 16px; }
    
    .form-group label {
      display: block; margin-bottom: 6px; font-weight: 500;
      color: #374151; font-size: 14px;
    }
    
    .form-group input, .form-group textarea {
      width: 100%; padding: 10px 12px; border: 1px solid #d1d5db;
      border-radius: 8px; font-size: 14px; outline: none;
      transition: border-color 0.2s;
    }
    
    .form-group input:focus, .form-group textarea:focus {
      border-color: #3b82f6; box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }
    
    .form-group textarea { resize: vertical; min-height: 80px; }
    
    .save-btn {
      background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
      color: white; border: none; padding: 12px 24px; border-radius: 8px;
      font-size: 14px; font-weight: 500; cursor: pointer;
      transition: all 0.2s; width: 100%;
    }
    
    .save-btn:hover {
      transform: translateY(-1px); box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
    }
    
    .status-dot {
      width: 8px; height: 8px; border-radius: 50%;
      display: inline-block; margin-right: 6px;
    }
    
    .status-dot.connected { background: #10b981; }
    .status-dot.disconnected { background: #ef4444; }
    
    .error-message {
      background: #fef2f2; border: 1px solid #fecaca;
      color: #dc2626; padding: 12px; border-radius: 8px;
      font-size: 13px; margin-top: 8px;
    }
    
    @media (max-width: 480px) {
      .chatbot-container { width: 95%; height: 90vh; }
      .message-bubble { max-width: 85%; }
    }
  </style>
</head>
<body>
  <div class="chatbot-container">
    <div class="chatbot-header">
      <div class="header-badge">ğŸ§  RAG AI</div>
      <div class="header-controls">
        <button class="control-btn" onclick="clearChat()" title="ëŒ€í™” ì´ˆê¸°í™”">ğŸ—‘ï¸</button>
      </div>
      <div class="header-title">ë¶€ì‚°ì‹œ ì—¬ê¶Œë°œê¸‰ ë¯¼ì› ìƒë‹´</div>
      <div class="header-subtitle">AI ê¸°ë°˜ ì‹¤ì‹œê°„ ë¬¸ì„œ ê²€ìƒ‰ ì„œë¹„ìŠ¤</div>
    </div>

    <div class="chat-messages" id="chatMessages">
      <div class="message bot">
        <div class="message-avatar bot-avatar">ğŸ¤–</div>
        <div class="message-bubble">
          ì•ˆë…•í•˜ì„¸ìš”! ë¶€ì‚°ê´‘ì—­ì‹œ ì—¬ê¶Œë°œê¸‰ ë¯¼ì› ì „ë‹´ AI ìƒë‹´ì›ì…ë‹ˆë‹¤.<br><br>
          <strong>ì œê³µ ì„œë¹„ìŠ¤:</strong><br>
          â€¢ ì—¬ê¶Œ ì‹ ê·œë°œê¸‰/ì¬ë°œê¸‰ ì•ˆë‚´<br>
          â€¢ í•„ìš”ì„œë¥˜ ë° ìˆ˜ìˆ˜ë£Œ ì •ë³´<br>
          â€¢ ë°œê¸‰ì ˆì°¨ ë° ì†Œìš”ê¸°ê°„<br>
          â€¢ ì˜¨ë¼ì¸ ì‹ ì²­ ë°©ë²•<br><br>
          ì—¬ê¶Œ ê´€ë ¨ ê¶ê¸ˆí•œ ì ì„ ì–¸ì œë“  ì§ˆë¬¸í•´ì£¼ì„¸ìš”.
        </div>
      </div>
    </div>

    <div class="quick-suggestions" id="quickSuggestions">
      <div class="suggestion-chip" onclick="askQuestion('ì‹ ê·œ ì—¬ê¶Œ ë°œê¸‰ ë°©ë²• ì•Œë ¤ì£¼ì„¸ìš”')">ì‹ ê·œ ë°œê¸‰ ë°©ë²•</div>
      <div class="suggestion-chip" onclick="askQuestion('ì—¬ê¶Œ ì¬ë°œê¸‰ í•„ìš”ì„œë¥˜ëŠ” ë¬´ì—‡ì¸ê°€ìš”')">ì¬ë°œê¸‰ ì„œë¥˜</div>
      <div class="suggestion-chip" onclick="askQuestion('ì—¬ê¶Œ ë°œê¸‰ ìˆ˜ìˆ˜ë£Œë¥¼ ì•Œë ¤ì£¼ì„¸ìš”')">ë°œê¸‰ ìˆ˜ìˆ˜ë£Œ</div>
      <div class="suggestion-chip" onclick="askQuestion('ì—¬ê¶Œ ë°œê¸‰ ì†Œìš”ì‹œê°„ì€ ì–¼ë§ˆë‚˜ ê±¸ë¦¬ë‚˜ìš”')">ì†Œìš”ì‹œê°„</div>
      <div class="suggestion-chip" onclick="askQuestion('ì˜¨ë¼ì¸ìœ¼ë¡œ ì—¬ê¶Œ ì‹ ì²­í•  ìˆ˜ ìˆë‚˜ìš”')">ì˜¨ë¼ì¸ ì‹ ì²­</div>
      <div class="suggestion-chip" onclick="askQuestion('ì—¬ê¶Œ ì‚¬ì§„ ê·œê²© ê¸°ì¤€ì„ ì•Œë ¤ì£¼ì„¸ìš”')">ì‚¬ì§„ ê·œê²©</div>
    </div>

    <div class="typing-indicator" id="typingIndicator">
      <div class="message-avatar bot-avatar">ğŸ¤–</div>
      <div class="typing-bubble">
        <div class="spinner"></div>
        ê´€ë ¨ ë¬¸ì„œë¥¼ ê²€ìƒ‰í•˜ê³  ë¶„ì„í•˜ëŠ” ì¤‘...
      </div>
    </div>

    <div class="api-status" id="apiStatus">
      <span class="status-dot connected"></span>
      CLOVA Studio RAG API ì—°ê²° ì™„ë£Œ
    </div>

    <div class="input-area">
      <div class="input-container">
        <input type="text" id="messageInput" class="message-input" 
               placeholder="ì—¬ê¶Œ ê´€ë ¨ ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”..." 
               onkeypress="handleKeyPress(event)">
        <button class="send-button" onclick="sendMessage()" id="sendButton">â¤</button>
      </div>
    </div>
  </div>

  <script>
    // CLOVA Studio RAG API ì„¤ì • (ì§ì ‘ í¬í•¨)
    let apiConfig = {
      endpoint: 'https://clovastudio.stream.ntruss.com/v1/api-tools/rag-reasoning',
      apiKey: 'nv-2a8de249-3782-434e-9215-8c2432637ed8',
      serviceId: '68ad0c206251e148f1b5f324',
      systemPrompt: 'ë‹¹ì‹ ì€ ë¶€ì‚°ê´‘ì—­ì‹œ ì—¬ê¶Œë°œê¸‰ ì—…ë¬´ ì „ë¬¸ ìƒë‹´ì›ì…ë‹ˆë‹¤. ì—¬ê¶Œ ì‹ ê·œë°œê¸‰, ì¬ë°œê¸‰, í•„ìš”ì„œë¥˜, ìˆ˜ìˆ˜ë£Œ, ì ˆì°¨ ë“±ì— ëŒ€í•œ ì •í™•í•˜ê³  ìµœì‹ ì˜ ì •ë³´ë¥¼ ì œê³µí•˜ì„¸ìš”. ë‹µë³€í•  ë•ŒëŠ” ê´€ë ¨ ë²•ë ¹ì´ë‚˜ ê³µì‹ ë¬¸ì„œì˜ ê·¼ê±°ë¥¼ ì œì‹œí•˜ê³ , ë¶ˆí™•ì‹¤í•œ ë‚´ìš©ì€ ëª…í™•íˆ í‘œí˜„í•˜ì„¸ìš”. ë¶€ì‚°ì‹œë¯¼ì˜ ì…ì¥ì—ì„œ ì¹œì ˆí•˜ê³  ì´í•´í•˜ê¸° ì‰½ê²Œ ì•ˆë‚´í•´ì£¼ì„¸ìš”.',
      temperature: 0.3
    };

    let conversationHistory = [];
    let isProcessing = false;

    // ì´ˆê¸°í™”
    document.addEventListener('DOMContentLoaded', function() {
      // API ì—°ê²° ìƒíƒœ í‘œì‹œ
      updateApiStatus('connected', 'CLOVA Studio RAG API ì—°ê²° ì™„ë£Œ');
      console.log('ë¶€ì‚°ì‹œ ì—¬ê¶Œë°œê¸‰ ë¯¼ì› RAG AI ì±—ë´‡ ì´ˆê¸°í™” ì™„ë£Œ');
    });

    // API ìƒíƒœ ì—…ë°ì´íŠ¸
    function updateApiStatus(status, message) {
      const statusElement = document.getElementById('apiStatus');
      statusElement.className = `api-status ${status}`;
      statusElement.innerHTML = `<span class="status-dot ${status === 'connected' ? 'connected' : 'disconnected'}"></span>${message}`;
      statusElement.style.display = 'block';
      
      // 3ì´ˆ í›„ ìˆ¨ê¸°ê¸°
      if (status === 'connected') {
        setTimeout(() => {
          statusElement.style.display = 'none';
        }, 3000);
      }
    }

    // ë©”ì‹œì§€ ê´€ë¦¬
    function addMessage(text, isUser = false, sources = null) {
      const messagesContainer = document.getElementById('chatMessages');
      const messageDiv = document.createElement('div');
      messageDiv.className = `message ${isUser ? 'user' : 'bot'}`;
      
      const avatar = document.createElement('div');
      avatar.className = `message-avatar ${isUser ? 'user-avatar' : 'bot-avatar'}`;
      avatar.textContent = isUser ? 'ğŸ‘¤' : 'ğŸ¤–';
      
      const bubble = document.createElement('div');
      bubble.className = 'message-bubble';
      bubble.innerHTML = text.replace(/\n/g, '<br>');
      
      // ì°¸ì¡° ë¬¸ì„œ ì¶”ê°€
      if (sources && sources.length > 0) {
        const sourcesDiv = document.createElement('div');
        sourcesDiv.className = 'reference-sources';
        sourcesDiv.innerHTML = `<strong>ì°¸ì¡° ë¬¸ì„œ:</strong><br>${sources.map(s => `â€¢ ${s}`).join('<br>')}`;
        bubble.appendChild(sourcesDiv);
      }
      
      messageDiv.appendChild(avatar);
      messageDiv.appendChild(bubble);
      messagesContainer.appendChild(messageDiv);
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
    }

    function showTypingIndicator() {
      document.getElementById('typingIndicator').style.display = 'flex';
      document.getElementById('chatMessages').scrollTop = document.getElementById('chatMessages').scrollHeight;
    }

    function hideTypingIndicator() {
      document.getElementById('typingIndicator').style.display = 'none';
    }

    // RAG API í˜¸ì¶œ
    async function callRagApi(message) {
      if (!apiConfig.endpoint || !apiConfig.apiKey) {
        throw new Error('API ì„¤ì •ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤');
      }

      const messages = [
        { role: "system", content: apiConfig.systemPrompt },
        ...conversationHistory,
        { role: "user", content: message }
      ];

      const requestBody = {
        messages: messages,
        maxTokens: 4000,
        temperature: apiConfig.temperature,
        tools: [
          {
            type: "function",
            function: {
              name: "search_passport_documents",
              description: "ë¶€ì‚°ê´‘ì—­ì‹œ ì—¬ê¶Œ ë°œê¸‰ ê´€ë ¨ ê³µì‹ ë¬¸ì„œì™€ ê·œì •ì„ ê²€ìƒ‰í•©ë‹ˆë‹¤. ì—¬ê¶Œ ì‹ ì²­ ì ˆì°¨, í•„ìš”ì„œë¥˜, ìˆ˜ìˆ˜ë£Œ, ë°œê¸‰ê¸°ê°„, ì‚¬ì§„ ê·œê²© ë“±ì˜ ì •ë³´ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
              parameters: {
                type: "object",
                properties: {
                  query: {
                    type: "string",
                    description: "ê²€ìƒ‰í•  í‚¤ì›Œë“œ (ì˜ˆ: ì‹ ê·œë°œê¸‰, ì¬ë°œê¸‰, í•„ìš”ì„œë¥˜, ìˆ˜ìˆ˜ë£Œ ë“±)"
                  },
                  category: {
                    type: "string",
                    description: "ë¬¸ì„œ ì¹´í…Œê³ ë¦¬",
                    enum: ["ì‹ ê·œë°œê¸‰", "ì¬ë°œê¸‰", "í•„ìš”ì„œë¥˜", "ìˆ˜ìˆ˜ë£Œ", "ì ˆì°¨ì•ˆë‚´", "ì‚¬ì§„ê·œê²©", "ì˜¨ë¼ì¸ì‹ ì²­", "ì¼ë°˜ë¬¸ì˜"]
                  }
                },
                required: ["query"]
              }
            }
          }
        ],
        toolChoice: "auto"
      };

      const response = await fetch(apiConfig.endpoint, {
        method: 'POST',
        headers: {
          'Authorization': `Bearer ${apiConfig.apiKey}`,
          'Content-Type': 'application/json',
          'X-NCP-CLOVASTUDIO-API-KEY': apiConfig.apiKey,
          'X-NCP-APIGW-API-KEY': apiConfig.apiKey
        },
        body: JSON.stringify(requestBody)
      });

      if (!response.ok) {
        const errorText = await response.text();
        throw new Error(`API ìš”ì²­ ì‹¤íŒ¨ (${response.status}): ${errorText}`);
      }

      const data = await response.json();
      
      if (data.status && data.status.code === "20000") {
        const resultMessage = data.result.message;
        
        return {
          content: resultMessage.content || "ì£„ì†¡í•©ë‹ˆë‹¤. ë‹µë³€ì„ ìƒì„±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",
          toolCalls: resultMessage.toolCalls || [],
          sources: data.result.citedDocuments || []
        };
      } else {
        throw new Error(`API ì˜¤ë¥˜: ${data.status ? data.status.message : 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'}`);
      }
    }

    // ë©”ì‹œì§€ ì „ì†¡
    async function sendMessage() {
      if (isProcessing) return;
      
      const input = document.getElementById('messageInput');
      const message = input.value.trim();
      if (!message) return;

      const sendButton = document.getElementById('sendButton');
      
      try {
        isProcessing = true;
        sendButton.disabled = true;
        
        addMessage(message, true);
        input.value = '';
        showTypingIndicator();

        const response = await callRagApi(message);
        hideTypingIndicator();
        
        let botMessage = response.content;
        let sources = [];
        
        // Function calling ì²˜ë¦¬
        if (response.toolCalls && response.toolCalls.length > 0) {
          const toolCall = response.toolCalls[0];
          const args = JSON.parse(toolCall.function.arguments);
          
          // ê²€ìƒ‰ ì‹œë®¬ë ˆì´ì…˜ (ì‹¤ì œë¡œëŠ” ê²€ìƒ‰ API í˜¸ì¶œ)
          const searchResults = simulateDocumentSearch(args.query, args.category);
          sources = searchResults.sources;
          
          if (searchResults.content) {
            botMessage = searchResults.content;
          }
        }
        
        addMessage(botMessage, false, sources);
        
        // ëŒ€í™” íˆìŠ¤í† ë¦¬ ì—…ë°ì´íŠ¸
        conversationHistory.push({ role: 'user', content: message });
        conversationHistory.push({ role: 'assistant', content: botMessage });
        
        // íˆìŠ¤í† ë¦¬ ì œí•œ (ìµœê·¼ 10ê°œ ëŒ€í™”)
        if (conversationHistory.length > 20) {
          conversationHistory = conversationHistory.slice(-20);
        }

      } catch (error) {
        hideTypingIndicator();
        addMessage(`ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}<br><br>API ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”.`, false);
        console.error('API í˜¸ì¶œ ì˜¤ë¥˜:', error);
      } finally {
        isProcessing = false;
        sendButton.disabled = false;
      }
    }

    // ë¬¸ì„œ ê²€ìƒ‰ ì‹œë®¬ë ˆì´ì…˜ (ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” ì‹¤ì œ ê²€ìƒ‰ API ì‚¬ìš©)
    function simulateDocumentSearch(query, category) {
      const mockResponses = {
        "ì‹ ê·œë°œê¸‰": {
          content: "ë¶€ì‚°ê´‘ì—­ì‹œì—ì„œ ì‹ ê·œ ì—¬ê¶Œì„ ë°œê¸‰ë°›ìœ¼ë ¤ë©´ ë‹¤ìŒ ì ˆì°¨ë¥¼ ë”°ë¥´ì„¸ìš”:\n\n1. **í•„ìš”ì„œë¥˜ ì¤€ë¹„**\n- ì—¬ê¶Œë°œê¸‰ì‹ ì²­ì„œ 1ë¶€\n- ì—¬ê¶Œìš© ì‚¬ì§„ 1ë§¤ (3.5Ã—4.5cm, 6ê°œì›” ì´ë‚´ ì´¬ì˜)\n- ì‹ ë¶„ì¦ (ì£¼ë¯¼ë“±ë¡ì¦, ìš´ì „ë©´í—ˆì¦ ë“±)\n- ê¸°ë³¸ì¦ëª…ì„œ 1ë¶€ (ì£¼ë¯¼ì„¼í„° ë°œê¸‰)\n\n2. **ìˆ˜ìˆ˜ë£Œ**\n- 10ë…„ ë³µìˆ˜ì—¬ê¶Œ: 53,000ì›\n- 5ë…„ ë³µìˆ˜ì—¬ê¶Œ: 50,000ì›\n- ë‹¨ìˆ˜ì—¬ê¶Œ: 20,000ì›\n\n3. **ë°œê¸‰ì ˆì°¨**\n- ë¶€ì‚°ì§€ë°©ì—¬ê¶Œì‚¬ë¬´ì†Œ ë˜ëŠ” êµ¬Â·êµ°ì²­ ì—¬ê¶Œì—…ë¬´ ë‹´ë‹¹ë¶€ì„œ ë°©ë¬¸\n- ì„œë¥˜ ì œì¶œ ë° ìˆ˜ìˆ˜ë£Œ ë‚©ë¶€\n- ë³¸ì¸ í™•ì¸ ì ˆì°¨\n- 4-6ì¼ í›„ ìˆ˜ë ¹ (ê¸´ê¸‰ë°œê¸‰ ì‹œ 1-2ì¼)\n\nì˜¨ë¼ì¸ ì‚¬ì „ì‹ ì²­ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.",
          sources: ["ì—¬ê¶Œë²• ì‹œí–‰ë ¹", "ë¶€ì‚°ê´‘ì—­ì‹œ ì—¬ê¶Œì—…ë¬´ ì²˜ë¦¬ì§€ì¹¨", "ì™¸êµë¶€ ì—¬ê¶Œë°œê¸‰ ì•ˆë‚´"]
        },
        "ì¬ë°œê¸‰": {
          content: "ì—¬ê¶Œ ì¬ë°œê¸‰ì´ í•„ìš”í•œ ê²½ìš°ì™€ ì ˆì°¨ë¥¼ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤:\n\n**ì¬ë°œê¸‰ ì‚¬ìœ **\n- ìœ íš¨ê¸°ê°„ ë§Œë£Œ\n- ì—¬ê¶Œ ë¶„ì‹¤/ë„ë‚œ\n- ì—¬ê¶Œ í›¼ì†\n- ê°œëª… ë“± ì¸ì ì‚¬í•­ ë³€ê²½\n- ì‚¬ì¦ë€ ë¶€ì¡±\n\n**í•„ìš”ì„œë¥˜**\n- ì—¬ê¶Œë°œê¸‰ì‹ ì²­ì„œ\n- ì—¬ê¶Œìš© ì‚¬ì§„ 1ë§¤\n- ì‹ ë¶„ì¦\n- ê¸°ì¡´ ì—¬ê¶Œ (ìˆëŠ” ê²½ìš°)\n- ë¶„ì‹¤ì‹ ê³ ì„œ (ë¶„ì‹¤ ì‹œ)\n- ê°€ì¡±ê´€ê³„ì¦ëª…ì„œ (ê°œëª… ì‹œ)\n\n**ìˆ˜ìˆ˜ë£Œ**: ì‹ ê·œë°œê¸‰ê³¼ ë™ì¼\n\n**ì†Œìš”ê¸°ê°„**: 4-6ì¼ (ê¸´ê¸‰ë°œê¸‰ ì‹œ 1-2ì¼, ì¶”ê°€ ìˆ˜ìˆ˜ë£Œ 20,000ì›)\n\në¶„ì‹¤ ì‹œì—ëŠ” ì¦‰ì‹œ ì—¬ê¶Œë¶„ì‹¤ì‹ ê³ ë¥¼ í•´ì£¼ì„¸ìš”.",
          sources: ["ì—¬ê¶Œë²•", "ë¶€ì‚°ì‹œ ì—¬ê¶Œ ì¬ë°œê¸‰ ì—…ë¬´ì²˜ë¦¬ ë§¤ë‰´ì–¼", "ì—¬ê¶Œ ë¶„ì‹¤ì‹ ê³  ê·œì •"]
        },
        "ìˆ˜ìˆ˜ë£Œ": {
          content: "ë¶€ì‚°ì‹œ ì—¬ê¶Œ ë°œê¸‰ ìˆ˜ìˆ˜ë£Œ ì•ˆë‚´:\n\n**ì¼ë°˜ ì—¬ê¶Œ**\n- 10ë…„ ë³µìˆ˜ì—¬ê¶Œ: 53,000ì›\n- 5ë…„ ë³µìˆ˜ì—¬ê¶Œ: 50,000ì›\n- ë‹¨ìˆ˜ì—¬ê¶Œ: 20,000ì›\n\n**ê¸´ê¸‰ ë°œê¸‰ ì‹œ ì¶”ê°€ìˆ˜ìˆ˜ë£Œ**\n- 20,000ì› (ì¼ë°˜ ìˆ˜ìˆ˜ë£Œì— ì¶”ê°€)\n\n**ê²°ì œ ë°©ë²•**\n- í˜„ê¸ˆ\n- ì‹ ìš©ì¹´ë“œ\n- ì²´í¬ì¹´ë“œ\n\n**ë©´ì œ ëŒ€ìƒ**\n- êµ­ê°€ìœ ê³µì ë³¸ì¸\n- ë…ë¦½ìœ ê³µì ë³¸ì¸\n- 5.18 ë¯¼ì£¼ìœ ê³µì ë³¸ì¸\n- ê¸°íƒ€ ë²•ë ¹ì—ì„œ ì •í•œ ë©´ì œ ëŒ€ìƒì\n\në©´ì œ ëŒ€ìƒìëŠ” ê´€ë ¨ ì¦ëª…ì„œë¥¼ ì§€ì°¸í•´ì£¼ì„¸ìš”.",
          sources: ["ì—¬ê¶Œ ìˆ˜ìˆ˜ë£Œ ê³ ì‹œ", "ë¶€ì‚°ì‹œ ì—¬ê¶Œì—…ë¬´ ìˆ˜ìˆ˜ë£Œ ê·œì •", "êµ­ê°€ìœ ê³µì ì˜ˆìš°ë²•"]
        },
        "ì‚¬ì§„ê·œê²©": {
          content: "ì—¬ê¶Œìš© ì‚¬ì§„ ê·œê²© ì•ˆë‚´:\n\n**í¬ê¸°**: 3.5cm Ã— 4.5cm\n\n**ì´¬ì˜ ê¸°ì¤€**\n- 6ê°œì›” ì´ë‚´ ì´¬ì˜\n- ì •ë©´ ì‘ì‹œ, ë¬´í‘œì • ë˜ëŠ” ìì—°ìŠ¤ëŸ¬ìš´ í‘œì •\n- ë¨¸ë¦¬ ê¸¸ì´: 2.3~3.6cm (í„± ëì—ì„œ ì •ìˆ˜ë¦¬ê¹Œì§€)\n- ì–¼êµ´ ê¸¸ì´: 2.5~3.5cm (í„± ëì—ì„œ ëˆˆì¹ê¹Œì§€)\n\n**ë°°ê²½**: í°ìƒ‰ ë˜ëŠ” ì˜…ì€ íšŒìƒ‰\n\n**ë³µì¥**\n- ì¼ìƒë³µ ì°©ìš©\n- ì œë³µ, í°ìƒ‰ ì˜ìƒ ì§€ì–‘\n- ëª¨ì, ì„ ê¸€ë¼ìŠ¤, ì»¬ëŸ¬ë Œì¦ˆ ì°©ìš© ê¸ˆì§€\n\n**ì¢…êµì  ì˜ìƒ**: ì¼ìƒì  ì°©ìš© ì‹œ í—ˆìš©\n\n**ì£¼ì˜ì‚¬í•­**\n- í¬í† ìƒµ ë“± ê³¼ë„í•œ ë³´ì • ê¸ˆì§€\n- ì¸í™”ì§€ì— ì¶œë ¥ (ë””ì§€í„¸ ì¶œë ¥ ë¶ˆê°€)\n- ì ‘ì°©ì œ ì‚¬ìš© ê¸ˆì§€ (ìŠ¤í…Œì´í”ŒëŸ¬ ì´ìš©)\n\nê·œê²©ì— ë§ì§€ ì•Šìœ¼ë©´ ì¬ì´¬ì˜ì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
          sources: ["ICAO ì—¬ê¶Œì‚¬ì§„ í‘œì¤€", "ì™¸êµë¶€ ì—¬ê¶Œì‚¬ì§„ ê·œê²© ì•ˆë‚´", "ë¶€ì‚°ì‹œ ì—¬ê¶Œì‚¬ì§„ ê²€ìˆ˜ ê¸°ì¤€"]
        }
      };

      const response = mockResponses[category] || mockResponses[query] || {
        content: "í•´ë‹¹ ì§ˆë¬¸ì— ëŒ€í•œ êµ¬ì²´ì ì¸ ì •ë³´ë¥¼ ì°¾ê³  ìˆìŠµë‹ˆë‹¤. ë¶€ì‚°ê´‘ì—­ì‹œ ì—¬ê¶Œì—…ë¬´ì™€ ê´€ë ¨ëœ ìì„¸í•œ ë‚´ìš©ì€ ë¶€ì‚°ì§€ë°©ì—¬ê¶Œì‚¬ë¬´ì†Œ(051-440-4600) ë˜ëŠ” ë¶€ì‚°ì‹œì²­ ë¯¼ì›ì½œì„¼í„°(120)ë¡œ ë¬¸ì˜í•˜ì‹œë©´ ì •í™•í•œ ì•ˆë‚´ë¥¼ ë°›ìœ¼ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
        sources: ["ë¶€ì‚°ê´‘ì—­ì‹œ ì—¬ê¶Œì—…ë¬´ ì•ˆë‚´", "ë¶€ì‚°ì§€ë°©ì—¬ê¶Œì‚¬ë¬´ì†Œ ì—°ë½ì²˜"]
      };

      return response;
    }

    // í€µ ì§ˆë¬¸
    function askQuestion(question) {
      document.getElementById('messageInput').value = question;
      sendMessage();
    }

    // í‚¤ë³´ë“œ ì´ë²¤íŠ¸
    function handleKeyPress(event) {
      if (event.key === 'Enter' && !event.shiftKey) {
        event.preventDefault();
        sendMessage();
      }
    }

    // ëŒ€í™” ì´ˆê¸°í™”
    function clearChat() {
      if (confirm('ëŒ€í™” ë‚´ì—­ì„ ëª¨ë‘ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        conversationHistory = [];
        const messagesContainer = document.getElementById('chatMessages');
        messagesContainer.innerHTML = `
          <div class="message bot">
            <div class="message-avatar bot-avatar">ğŸ¤–</div>
            <div class="message-bubble">
              ëŒ€í™”ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.<br>
              ì—¬ê¶Œ ê´€ë ¨ ì§ˆë¬¸ì„ ì–¸ì œë“  í•´ì£¼ì„¸ìš”!
            </div>
          </div>
        `;
      }
    }
  </script>
</body>
</html>
